{"ast":null,"code":"var _jsxFileName = \"/Users/vigneshchowdary/Desktop/untitled folder 5/CryptoBucks-Final-Code/src/context/StorageContext.js\",\n  _s = $RefreshSig$();\n/* eslint-disable react-hooks/exhaustive-deps */\nimport { createContext, useContext, useEffect, useLayoutEffect, useState } from \"react\";\nimport { CryptoContext } from \"./CryptoContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const StorageContext = /*#__PURE__*/createContext({});\nexport const StorageProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [allCoins, setAllCoins] = useState([]);\n  const [savedData, setSavedData] = useState();\n  let {\n    currency,\n    sortBy\n  } = useContext(CryptoContext);\n  const saveCoin = coinId => {\n    let oldCoins = JSON.parse(localStorage.getItem(\"coins\"));\n    if (oldCoins.includes(coinId)) {\n      return null;\n    } else {\n      let newCoin = [...oldCoins, coinId];\n      setAllCoins(newCoin);\n      localStorage.setItem(\"coins\", JSON.stringify(newCoin));\n    }\n  };\n  const removeCoin = coinId => {\n    let oldCoins = JSON.parse(localStorage.getItem(\"coins\"));\n    let newCoin = oldCoins.filter(coin => coin !== coinId);\n    setAllCoins(newCoin);\n    localStorage.setItem(\"coins\", JSON.stringify(newCoin));\n  };\n  const getSavedData = async function () {\n    let totalCoins = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : allCoins;\n    try {\n      const data = await fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=${currency}&ids=${totalCoins.join(\",\")}&order=${sortBy}&sparkline=false&price_change_percentage=1h%2C24h%2C7d`).then(res => res.json()).then(json => json);\n      setSavedData(data);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const resetSavedResult = () => {\n    getSavedData();\n  };\n  useEffect(() => {\n    if (allCoins.length > 0) {\n      getSavedData(allCoins);\n    } else {\n      setSavedData();\n    }\n  }, [allCoins]);\n  useLayoutEffect(() => {\n    let isThere = JSON.parse(localStorage.getItem(\"coins\")) || false;\n    if (!isThere) {\n      //set the localstorage with empty array\n      localStorage.setItem(\"coins\", JSON.stringify([]));\n    } else {\n      //set the state with the current values from the local storage\n      let totalCoins = JSON.parse(localStorage.getItem(\"coins\"));\n      setAllCoins(totalCoins);\n      if (totalCoins.length > 0) {\n        getSavedData(totalCoins);\n      }\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(StorageContext.Provider, {\n    value: {\n      saveCoin,\n      allCoins,\n      removeCoin,\n      savedData,\n      resetSavedResult\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n};\n_s(StorageProvider, \"W3cCItCx6xjEOqv2bHVTSLrGM+s=\");\n_c = StorageProvider;\nvar _c;\n$RefreshReg$(_c, \"StorageProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useLayoutEffect","useState","CryptoContext","jsxDEV","_jsxDEV","StorageContext","StorageProvider","_ref","_s","children","allCoins","setAllCoins","savedData","setSavedData","currency","sortBy","saveCoin","coinId","oldCoins","JSON","parse","localStorage","getItem","includes","newCoin","setItem","stringify","removeCoin","filter","coin","getSavedData","totalCoins","arguments","length","undefined","data","fetch","join","then","res","json","error","console","log","resetSavedResult","isThere","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/vigneshchowdary/Desktop/untitled folder 5/CryptoBucks-Final-Code/src/context/StorageContext.js"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport {\n  createContext,\n  useContext,\n  useEffect,\n  useLayoutEffect,\n  useState,\n} from \"react\";\nimport { CryptoContext } from \"./CryptoContext\";\n\n\nexport const StorageContext = createContext({});\n\n\nexport const StorageProvider = ({ children }) => {\n  const [allCoins, setAllCoins] = useState([]);\n  const [savedData, setSavedData] = useState();\n\n  let { currency, sortBy } = useContext(CryptoContext);\n\n  const saveCoin = (coinId) => {\n    let oldCoins = JSON.parse(localStorage.getItem(\"coins\"));\n\n    if (oldCoins.includes(coinId)) {\n      return null;\n    } else {\n      let newCoin = [...oldCoins, coinId];\n      setAllCoins(newCoin);\n      localStorage.setItem(\"coins\", JSON.stringify(newCoin));\n    }\n  };\n\n  const removeCoin = (coinId) => {\n    let oldCoins = JSON.parse(localStorage.getItem(\"coins\"));\n\n    let newCoin = oldCoins.filter((coin) => coin !== coinId);\n\n    setAllCoins(newCoin);\n    localStorage.setItem(\"coins\", JSON.stringify(newCoin));\n  };\n\n  const getSavedData = async (totalCoins = allCoins) => {\n    try {\n      const data = await fetch(\n        `https://api.coingecko.com/api/v3/coins/markets?vs_currency=${currency}&ids=${totalCoins.join(\n          \",\"\n        )}&order=${sortBy}&sparkline=false&price_change_percentage=1h%2C24h%2C7d`\n      )\n        .then((res) => res.json())\n        .then((json) => json);\n\n\n      setSavedData(data);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const resetSavedResult = () => {\n    getSavedData();\n  };\n\n  useEffect(() => {\n    if (allCoins.length > 0) {\n      getSavedData(allCoins);\n    } else {\n      setSavedData();\n    }\n  }, [allCoins]);\n\n  useLayoutEffect(() => {\n    let isThere = JSON.parse(localStorage.getItem(\"coins\")) || false;\n\n    if (!isThere) {\n      //set the localstorage with empty array\n      localStorage.setItem(\"coins\", JSON.stringify([]));\n    } else {\n      //set the state with the current values from the local storage\n      let totalCoins = JSON.parse(localStorage.getItem(\"coins\"));\n      setAllCoins(totalCoins);\n\n      if (totalCoins.length > 0) {\n        getSavedData(totalCoins);\n      }\n    }\n  }, []);\n\n  return (\n    <StorageContext.Provider\n      value={{\n        saveCoin,\n        allCoins,\n        removeCoin,\n        savedData,\n        resetSavedResult,\n      }}\n    >\n      {children}\n    </StorageContext.Provider>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}